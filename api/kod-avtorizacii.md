# Код авторизации

Тип предоставления кода авторизации состоит из **2 частей**. Маркер кода должен быть запрошен, а затем обменен на маркер доступа.

### Получение кода аутентификации

```
GET
https://dash.leecyber.com/oauth/authorize/
```

**Запрос**

* **client\_id** (обязательно) **–** идентификатор клиента, делающего запрос
* **redirect\_uri** (необязательный|требоваемый) **—** URL-адрес, на который нужно перенаправить обратно. Этот параметр обязателен, если в настройках клиента не определен URI перенаправления И ИЛИ, если в настройках плагина задан параметр "принудительное URI перенаправления".
* **response\_type** (обязательно) — должен быть установлен в «код»
* **область** (необязательно) — область с разделителями пространства
* **state** (необязательно) – токен CSRF, сгенерированный клиентом. Это значение будет передано обратно клиенту.

**Ответ**

* **code** (string) – Код авторизации.
* **state** (mixed) — если в запросе указан параметр state, он будет возвращен.

### Получение маркера доступа

Получив код авторизации, необходимо сделать еще один запрос для получения маркера доступа. Код авторизации действителен только в течение примерно 30 секунд.

**Запрос**

```
POST
oauth/token
```

* **grant\_type** (обязательно) — должно быть «authorization\_code»
* **code** (обязательно) — код, возвращаемый сервером авторизации
* **client\_id** (обязательно) — идентификатор клиента
* **client\_secret** (обязательно) — секрет клиента
* **redirect\_uri** (необязательный|требоваемый) — URL-адрес для перенаправления пользователя обратно на
* **state** (необязательный|требоваемый) – токен CSRF. Требуется, если включен параметр "Принудительное состояние".

**Ответ**

Ответ будет в **формате JSON**

* **access\_token** — маркер доступа
* **expires\_in** — время истечения срока действия маркера доступа в секундах от текущего времени
* **token\_type** – Тип токена. "Носитель" поддерживается только
* **область** — области, авторизованные для данного маркера доступа.
* **refresh\_token** — маркер обновления

```
{
 "access_token": "dasdjlhadkjhi2u3ydah",
 "expires_in": 3600,
 "token_type": "Bearer",
 "scope": "basic",
 "refresh_token": "g1b4cph2kjnwojzofajvqsfzb2oltjthtermizhflkjfdgho9"
}
```

### Запрос информации о пользователе

<pre><code><strong>GET
</strong>oauth/me
</code></pre>

* **access\_token** (обязательно) — это должен быть действительный маркер доступа

**Ответ**

Ответ будет в **формате JSON**, содержащем имя пользователя, адрес электронной почты и другую информацию о пользователе, авторизовавшем маркер доступа.
